name: windows_dism_sfc_chkdsk_maintenance.ps1
description: Runs DISM, SFC, and chkdsk for Windows system file repair and maintenance
language: PowerShell
runAs: SYSTEM_USER
timeout: 15
tags:
- Maintenance
- Windows
shared: true
favourite: false
readme: "Purpose\n-------\nRuns standard Windows health checks and repair commands\
  \ including DISM image health scans, disk checks, system file verification, and\
  \ component cleanup. Designed for unattended execution in RMM environments to perform\
  \ routine system maintenance and repair operations.\n\nUsage Notes\n-----------\n\
  - Configurable operations via hardcoded flags:\n  - RunDismScan: Check for image\
  \ corruption\n  - RunDismRestore: Repair image (only if corruption found)\n  - RunChkdsk:\
  \ Check disk integrity\n  - RunSfc: System File Checker\n- Smart logic: RestoreHealth\
  \ only runs if ScanHealth finds corruption\n- Optional reboot scheduling after maintenance\n\
  - Full output captured for logging\n\nRequirements\n------------\n- PowerShell 5.1\
  \ or later\n- Administrator privileges required\n- Windows 8.1/Server 2012 R2 or\
  \ later for DISM commands\n- Sufficient disk space for repair operations\n"
runtimeVariables: []
placeholderVariables: []
scriptId: '1907390810231676928'
lastPushedChecksum: sha256:be40dbe7f855076f
