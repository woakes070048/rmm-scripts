name: delprof2_keep_selected_profile.ps1
description: Deletes all Windows user profiles except the specified one and protected
  profiles
language: PowerShell
runAs: SYSTEM_USER
timeout: 15
tags:
- Administration
- Windows
shared: false
favourite: false
readme: '## Purpose

  Deletes ALL Windows user profiles EXCEPT the specified profile and protected ones
  (gaia, administrator). Uses DelProf2 utility.


  ## Usage Notes

  - Always protects: gaia, administrator profiles

  - Downloads DelProf2 directly (no Chocolatey required)

  - Cleans up after execution

  - DESTRUCTIVE OPERATION - profiles cannot be recovered


  ## Requirements

  - Windows 10/11

  - Admin privileges required

  - Internet access for DelProf2 download

  - Runtime variable: `profile_to_keep` (username of the profile to preserve)

  '
runtimeVariables:
- name: profile_to_keep
placeholderVariables: []
scriptId: '259059074357387264'
lastPushedChecksum: sha256:63a9cb329df9761e
