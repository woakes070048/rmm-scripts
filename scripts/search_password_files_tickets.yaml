name: search_password_files_tickets.ps1
description: Scans for password files in user profiles and creates SuperOps tickets for findings
language: PowerShell
runAs: SYSTEM_USER
timeout: 15
tags:
- Security
- Windows
shared: false
favourite: false
readme: |
  Purpose:
  Scans all user profiles on a Windows machine for files that may contain passwords or credentials. Creates a SuperOps ticket assigned to the requester associated with the asset when findings are detected.

  Usage Notes:
  - Searches Desktop, Documents, Downloads, Pictures, and cloud folders
  - Patterns include: *password*, *credential*, *creds*, *logins*, etc.
  - Critical findings trigger HIGH priority tickets
  - Optional Google Chat webhook alert in addition to ticket
  - Read-only operation - does not modify or delete files

  Requirements:
  - PowerShell 5.1 or later
  - Administrator privileges (to access other user profiles)
  - SuperOps API key with ticket creation permissions
runtimeVariables:
- name: SuperOpsApiKey
- name: GoogleChatWebhook
placeholderVariables: []
