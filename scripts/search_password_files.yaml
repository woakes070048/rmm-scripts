name: search_password_files.ps1
description: Searches user profiles for password and credential files
language: PowerShell
runAs: SYSTEM_USER
timeout: 15
tags:
- Security
- Windows
shared: false
favourite: false
readme: |
  Purpose
  -------
  Scans all user profiles on a Windows machine for files that may contain
  passwords or credentials. Useful for security audits to identify exposed
  sensitive data in common user directories.

  Usage Notes
  -----------
  - Searches Desktop, Documents, Downloads, Pictures, and cloud folders
  - Patterns include: *password*, *credential*, *creds*, *logins*, etc.
  - Critical patterns flagged: 1Password Emergency Kit, KeePass, etc.
  - Uses Windows Search Index if available, falls back to filesystem
  - Optional Google Chat webhook alert via $GoogleChatWebhook variable
  - Read-only operation - does not modify or delete files
  - File contents are NOT read, only metadata reported

  Requirements
  ------------
  - Windows 10/11
  - Administrator privileges (to access other user profiles)
  - PowerShell 5.1+
runtimeVariables:
- name: GoogleChatWebhook
placeholderVariables: []
