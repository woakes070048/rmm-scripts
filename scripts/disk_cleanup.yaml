name: disk_cleanup.ps1
description: Runs Windows Disk Cleanup plus SoftwareDistribution and WinSxS cleanup
language: PowerShell
runAs: SYSTEM_USER
timeout: 15
tags:
  - Cleanup
  - Disk
  - Windows
shared: true
favourite: false
readme: >
  ## Purpose

  Runs Windows Disk Cleanup utility on all fixed local drives, plus targeted
  cleanups for SoftwareDistribution, WinSxS, and Search Index to free up disk
  space.


  ## Usage Notes

  - Runs cleanmgr.exe with /verylowdisk flag on all fixed drives

  - Performs DISM WinSxS cleanup on C: drive

  - Clears SoftwareDistribution folder

  - Rebuilds Search Index

  - Reboot recommended after completion


  ## Requirements

  - Windows 10/11 with cleanmgr.exe and DISM

  - WMI service running

  - Admin privileges for DISM/services
runtimeVariables: []
placeholderVariables: []
scriptId: "5261212187550191616"
lastPushedChecksum: sha256:4bedae12c53dbc95
lastPushedMetaChecksum: sha256:af0b9d4e684159b8
